import { useEffect, useRef, useState } from "react";
import { FieldValues, UseFormSetValue } from "react-hook-form";

type TopBtnsPropsType = {
   page: string,
   setValue: UseFormSetValue<FieldValues>,
   setShowExitModal: React.Dispatch<React.SetStateAction<boolean>>,
}

function TopBtns({ page, setValue, setShowExitModal }: TopBtnsPropsType) {
   const exitBtnRef = useRef<HTMLButtonElement>(null);
   const [isCircle, setIsCircle] = useState(false);

   useEffect(() => {
      const handleScroll = () => {
         if (window.scrollY >= 150) setIsCircle(true);
         else setIsCircle(false);
      }
      window.addEventListener("scroll", handleScroll);

      return () => {
         window.removeEventListener("scroll", handleScroll);
      }
   }, [exitBtnRef])

   return (
      <>
         <div className="w-full h-12 absolute top-0 flex items-center justify-between">
            <button
               type="button"
               className={`exit-btn ${isCircle ? "exit-btn-circle" : "exit-btn-ellipse"}`}
               onClick={() => setShowExitModal(true)}
               ref={exitBtnRef}
            >
               <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" className={`transition-all ${isCircle ? "w-4.5 lg:w-5" : "w-4 lg:w-5"}`}>
                  <path d="M13 3L8 8M8 8L3 13M8 8L13 13M8 8L3 3" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
               </svg>
               {
                  !isCircle && "خروج"
               }
            </button>

            <h2 className="font-Estedad-Black max-w-28 text-center">{page}</h2>

            <button
               type="submit"
               className={`save-btn ${isCircle ? "save-btn-circle" : "save-btn-ellipse"}`}
               onClick={() => setValue("shouldSave", true)}
            >
               {
                  !isCircle && "ذخیره"
               }
               <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" className={`transition-all ${isCircle ? "w-4.5 lg:w-5" : "w-4 lg:w-5"}`}>
                  <path d="M15.6 8C15.6 9.63787 15.5117 10.9267 15.286 11.9425C15.0612 12.9538 14.7056 13.6697 14.1877 14.1877C13.6697 14.7056 12.9538 15.0612 11.9425 15.286C10.9267 15.5117 9.63787 15.6 8 15.6C6.36213 15.6 5.07327 15.5117 4.05747 15.286C3.04621 15.0612 2.33027 14.7056 1.81234 14.1877C1.29441 13.6697 0.93878 12.9538 0.714037 11.9425C0.488284 10.9267 0.4 9.63787 0.4 8L0.4 7.99649L0.4 7.99298L0.4 7.98947L0.4 7.98596L0.4 7.98245L0.4 7.97895L0.4 7.97544L0.4 7.97194L0.4 7.96843L0.4 7.96493L0.4 7.96143L0.4 7.95793L0.4 7.95443L0.4 7.95093L0.4 7.94743L0.4 7.94394L0.4 7.94044L0.4 7.93695L0.4 7.93345L0.4 7.92996L0.4 7.92647L0.4 7.92298L0.4 7.91949L0.4 7.916L0.4 7.91251L0.4 7.90903L0.4 7.90554L0.4 7.90206L0.4 7.89857L0.4 7.89509L0.4 7.89161L0.4 7.88813L0.4 7.88465L0.4 7.88117L0.4 7.8777L0.4 7.87422L0.4 7.87075L0.4 7.86727L0.4 7.8638L0.4 7.86033L0.4 7.85686L0.4 7.85339L0.4 7.84992L0.4 7.84645L0.4 7.84298L0.4 7.83952L0.4 7.83605L0.4 7.83259L0.4 7.82912L0.4 7.82566L0.4 7.8222L0.4 7.81874L0.4 7.81528L0.4 7.81183L0.4 7.80837L0.4 7.80491L0.4 7.80146L0.4 7.79801L0.4 7.79455L0.4 7.7911L0.4 7.78765L0.4 7.7842L0.4 7.78075L0.4 7.77731L0.4 7.77386L0.4 7.77041L0.4 7.76697L0.4 7.76353L0.4 7.76008L0.4 7.75664L0.4 7.7532L0.4 7.74976L0.4 7.74632L0.4 7.74289L0.4 7.73945L0.4 7.73601L0.4 7.73258L0.4 7.72915L0.4 7.72572L0.4 7.72228L0.4 7.71885L0.4 7.71542L0.4 7.712L0.4 7.70857L0.4 7.70514L0.4 7.70172L0.4 7.69829L0.4 7.69487L0.4 7.69145L0.4 7.68803L0.4 7.68461L0.4 7.68119L0.4 7.67777L0.4 7.67435L0.4 7.67094L0.4 7.66752L0.4 7.66411L0.4 7.66069L0.4 7.65728L0.4 7.65387L0.4 7.65046L0.4 7.64705L0.4 7.64364L0.4 7.64024L0.4 7.63683L0.4 7.63343L0.4 7.63002L0.4 7.62662L0.4 7.62322L0.4 7.61982L0.4 7.61642L0.4 7.61302L0.4 7.60962L0.4 7.60622L0.4 7.60283L0.4 7.59943L0.4 7.59604L0.4 7.59265L0.4 7.58925L0.4 7.58586L0.4 7.58247L0.4 7.57908L0.4 7.5757L0.4 7.57231L0.4 7.56892L0.4 7.56554L0.4 7.56216L0.4 7.55877L0.4 7.55539L0.4 7.55201L0.4 7.54863L0.4 7.54525L0.4 7.54187L0.4 7.5385L0.4 7.53512L0.4 7.53175L0.4 7.52837L0.4 7.525L0.4 7.52163L0.4 7.51826L0.4 7.51489L0.4 7.51152L0.4 7.50815L0.4 7.50478L0.4 7.50142L0.4 7.49805L0.4 7.49469L0.4 7.49133L0.4 7.48797L0.4 7.48461L0.4 7.48125L0.4 7.47789L0.4 7.47453L0.4 7.47117L0.4 7.46782L0.4 7.46446L0.4 7.46111L0.4 7.45776L0.4 7.45441L0.4 7.45105L0.4 7.44771L0.4 7.44436L0.4 7.44101L0.4 7.43766L0.4 7.43432L0.4 7.43097L0.4 7.42763L0.4 7.42429L0.4 7.42095L0.4 7.4176L0.4 7.41427L0.4 7.41093L0.4 7.40759L0.4 7.40425L0.4 7.40092L0.4 7.39758L0.4 7.39425L0.4 7.39092L0.4 7.38758L0.4 7.38425L0.4 7.38092L0.4 7.3776L0.4 7.37427L0.4 7.37094L0.4 7.36762L0.4 7.36429L0.4 7.36097L0.4 7.35765L0.4 7.35432L0.4 7.351L0.4 7.34768L0.4 7.34437L0.4 7.34105L0.4 7.33773L0.4 7.33442L0.4 7.3311L0.4 7.32779L0.4 7.32447L0.4 7.32116L0.4 7.31785L0.4 7.31454L0.4 7.31123L0.4 7.30793L0.4 7.30462L0.4 7.30131L0.4 7.29801L0.4 7.29471L0.4 7.2914L0.4 7.2881L0.4 7.2848L0.4 7.2815L0.4 7.2782L0.4 7.27491L0.4 7.27161L0.4 7.26831L0.4 7.26502L0.4 7.26173L0.4 7.25843L0.4 7.25514L0.4 7.25185L0.4 7.24856L0.4 7.24527L0.4 7.24198L0.4 7.2387L0.4 7.23541L0.4 7.23213L0.4 7.22884L0.4 7.22556L0.4 7.22228L0.4 7.219L0.4 7.21572L0.4 7.21244L0.4 7.20916L0.4 7.20589L0.4 7.20261L0.4 7.19934L0.4 7.19606L0.4 7.19279L0.4 7.18952L0.4 7.18625L0.4 7.18298L0.4 7.17971L0.4 7.17644L0.4 7.17317L0.4 7.16991L0.4 7.16664L0.4 7.16338L0.4 7.16012L0.4 7.15685L0.4 7.15359L0.4 7.15033L0.4 7.14707L0.4 7.14382L0.4 7.14056L0.4 7.1373L0.4 7.13405L0.4 7.13079L0.4 7.12754L0.4 7.12429L0.4 7.12104L0.4 7.11779L0.4 7.11454L0.4 7.11129L0.4 7.10804L0.4 7.1048L0.4 7.10155L0.4 7.09831L0.4 7.09507L0.4 7.09182L0.4 7.08858L0.4 7.08534L0.4 7.0821L0.4 7.07887L0.4 7.07563L0.4 7.07239L0.4 7.06916L0.4 7.06592L0.4 7.06269L0.4 7.05946L0.4 7.05623L0.4 7.053L0.4 7.04977L0.4 7.04654L0.4 7.04331L0.4 7.04009L0.4 7.03686L0.4 7.03364L0.4 7.03041L0.4 7.02719L0.4 7.02397L0.4 7.02075L0.4 7.01753L0.4 7.01431L0.4 7.01109L0.4 7.00788L0.4 7.00466L0.4 7.00145L0.4 6.99823L0.4 6.99502L0.4 6.99181L0.4 6.9886L0.4 6.98539L0.4 6.98218L0.4 6.97897L0.4 6.97577L0.4 6.97256L0.4 6.96936L0.4 6.96615L0.4 6.96295L0.4 6.95975L0.4 6.95655L0.4 6.95335L0.4 6.95015L0.4 6.94695L0.4 6.94375L0.4 6.94056L0.4 6.93736L0.4 6.93417L0.4 6.93098L0.4 6.92778L0.4 6.92459L0.4 6.9214L0.4 6.91822L0.4 6.91503L0.4 6.91184L0.4 6.90865L0.4 6.90547L0.4 6.90229L0.4 6.8991L0.4 6.89592L0.4 6.89274L0.4 6.88956L0.4 6.88638L0.4 6.8832L0.4 6.88002L0.4 6.87685L0.4 6.87367L0.4 6.8705L0.4 6.86733L0.4 6.86415L0.4 6.86098L0.4 6.85781L0.4 6.85464L0.4 6.85147L0.4 6.84831L0.4 6.84514L0.4 6.84197L0.4 6.83881L0.4 6.83565L0.4 6.83248L0.4 6.82932L0.4 6.82616L0.4 6.823L0.4 6.81984L0.4 6.81669L0.4 6.81353L0.4 6.81037L0.4 6.80722L0.4 6.80407L0.4 6.80091L0.4 6.79776L0.4 6.79461L0.4 6.79146L0.4 6.78831L0.4 6.78516L0.4 6.78202L0.4 6.77887L0.4 6.77572L0.4 6.77258L0.4 6.76944L0.4 6.7663L0.4 6.76315L0.4 6.76001L0.4 6.75688L0.4 6.75374L0.4 6.7506L0.4 6.74746L0.4 6.74433L0.4 6.74119L0.4 6.73806L0.4 6.73493L0.4 6.7318L0.4 6.72867L0.4 6.72554L0.4 6.72241L0.4 6.71928L0.4 6.71616L0.4 6.71303L0.4 6.70991L0.4 6.70678L0.4 6.70366L0.4 6.70054L0.4 6.69742L0.4 6.6943L0.4 6.69118L0.4 6.68806L0.4 6.68494L0.4 6.68183L0.4 6.67871L0.4 6.6756L0.4 6.67249L0.4 6.66937L0.4 6.66626L0.4 6.66315L0.4 6.66005L0.4 6.65694L0.4 6.65383L0.4 6.65072L0.4 6.64762L0.4 6.64451L0.4 6.64141L0.4 6.63831L0.4 6.63521L0.4 6.63211L0.4 6.62901L0.4 6.62591L0.4 6.62281L0.4 6.61972L0.4 6.61662L0.4 6.61353L0.4 6.61043L0.4 6.60734L0.4 6.60425L0.4 6.60116L0.4 6.59807L0.4 6.59498L0.4 6.59189L0.4 6.5888L0.4 6.58572L0.4 6.58263L0.4 6.57955L0.4 6.57647L0.4 6.57339L0.4 6.5703L0.4 6.56722L0.4 6.56415L0.4 6.56107L0.4 6.55799L0.4 6.55491L0.4 6.55184L0.4 6.54876L0.4 6.54569L0.4 6.54262L0.4 6.53955L0.4 6.53648L0.4 6.53341L0.4 6.53034L0.4 6.52727L0.4 6.52421L0.4 6.52114L0.4 6.51808L0.4 6.51501L0.4 6.51195L0.4 6.50889L0.4 6.50583L0.4 6.50277L0.4 6.49971L0.4 6.49665L0.4 6.49359L0.4 6.49054L0.4 6.48748L0.4 6.48443L0.4 6.48138L0.4 6.47832L0.4 6.47527L0.4 6.47222L0.4 6.46917L0.4 6.46612L0.4 6.46308L0.4 6.46003L0.4 6.45698L0.4 6.45394L0.4 6.4509L0.4 6.44786L0.4 6.44481L0.4 6.44177L0.4 6.43873L0.4 6.4357L0.4 6.43266L0.4 6.42962L0.4 6.42658L0.4 6.42355L0.4 6.42052L0.4 6.41748L0.4 6.41445L0.4 6.41142L0.4 6.40839L0.4 6.40536L0.4 6.40233L0.4 6.39931L0.4 6.39628L0.4 6.39325L0.4 6.39023L0.4 6.38721L0.4 6.38418L0.4 6.38116L0.4 6.37814L0.4 6.37512L0.4 6.3721L0.4 6.36909L0.4 6.36607L0.4 6.36305L0.4 6.36004L0.4 6.35703L0.4 6.35401L0.4 6.351L0.4 6.34799L0.4 6.34498L0.4 6.34197L0.4 6.33896L0.4 6.33596L0.4 6.33295C0.4 4.90406 0.400808 3.87165 0.503829 3.0854C0.605498 2.30946 0.80019 1.83458 1.14338 1.48451C1.4861 1.13492 1.95937 0.930509 2.73964 0.813214C3.52973 0.694443 4.57085 0.672993 6.01104 0.644425C7.9549 0.605866 9.52751 0.594586 10.8023 0.714949C12.0785 0.835456 13.009 1.0846 13.693 1.53332C15.0265 2.40803 15.6 4.16921 15.6 8Z" stroke="#E4F4FD" strokeWidth="0.8" strokeLinecap="round" strokeLinejoin="round" />
                  <path d="M12.6565 14.6667C12.6565 13.381 12.6792 12.8667 12.6565 11.6667C12.6792 9.86675 12.6565 8.66675 11.0101 8.66675C8.90129 8.66675 6.55605 8.66675 5.00218 8.66675C3.33326 8.66675 3.33312 9.86675 3.33326 11.6667C3.3332 12.8667 3.33342 13.381 3.33326 14.6667" stroke="#E4F4FD" strokeWidth="0.8" strokeLinecap="round" strokeLinejoin="round" />
                  <path d="M10.6667 0.999919C10.6667 0.999919 10.6667 2.66659 10.6667 3.33325C10.6667 3.99992 10.6667 5.33325 9.33333 5.33325C8.22222 5.33325 6.44444 5.33325 5.33333 5.33325C4 5.33325 3.99996 3.99992 4 3.33325C4.00004 2.66659 4 1.33325 4 1.33325" stroke="#E4F4FD" strokeWidth="0.8" strokeLinecap="round" strokeLinejoin="round" />
                  <path d="M8 1.33333V3" stroke="#E4F4FD" strokeWidth="0.8" strokeLinecap="round" strokeLinejoin="round" />
                  <path d="M6 11L10 11" stroke="#E4F4FD" strokeWidth="0.8" strokeLinecap="round" strokeLinejoin="round" />
                  <path d="M6 13L10 13" stroke="#E4F4FD" strokeWidth="0.8" strokeLinecap="round" strokeLinejoin="round" />
               </svg>
            </button>
         </div>
      </>
   )
}

export default TopBtns